(function(t){function e(e){for(var r,i,u=e[0],a=e[1],s=e[2],f=0,b=[];f<u.length;f++)i=u[f],Object.prototype.hasOwnProperty.call(c,i)&&c[i]&&b.push(c[i][0]),c[i]=0;for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(t[r]=a[r]);l&&l(e);while(b.length)b.shift()();return o.push.apply(o,s||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],r=!0,u=1;u<n.length;u++){var a=n[u];0!==c[a]&&(r=!1)}r&&(o.splice(e--,1),t=i(i.s=n[0]))}return t}var r={},c={app:0},o=[];function i(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=r,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="";var u=window["webpackJsonp"]=window["webpackJsonp"]||[],a=u.push.bind(u);u.push=e,u=u.slice();for(var s=0;s<u.length;s++)e(u[s]);var l=a;o.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"0900":function(t,e,n){},"0f5c":function(t,e,n){},"283a":function(t,e,n){},"418d":function(t,e,n){},5628:function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("7a23"),c={id:"app"};function o(t,e,n,o,i,u){var a=Object(r["u"])("asideMenu"),s=Object(r["u"])("maskMap"),l=Object(r["u"])("lightbox");return Object(r["m"])(),Object(r["g"])("div",c,[Object(r["j"])(a),Object(r["j"])(s),Object(r["j"])(l)])}n("b0c0"),n("7db0"),n("d3b7"),n("d81d"),n("159b");var i=n("e11e"),u=n.n(i),a=n("5530"),s=n("1da1"),l=(n("96cf"),n("fb6a"),n("4de4"),n("caad"),n("2532"),Object(r["q"])({currCity:"臺北市",currDistrict:"北投區",infoBoxStoreId:null,keywords:"",showModal:!1,location:[],stores:[],cityList:Object(r["c"])((function(){return l.location.map((function(t){return t.name}))})),districtList:Object(r["c"])((function(){var t;return(null===(t=l.location.find((function(t){return t.name===l.currCity})))||void 0===t?void 0:t.districts)||[]})),currDistrictInfo:Object(r["c"])((function(){return l.districtList.find((function(t){return t.name===l.currDistrict}))||{}})),filteredStores:Object(r["c"])((function(){return l.keywords?l.stores.filter((function(t){return t.name.includes(l.keywords)})).slice(0,30):l.stores.filter((function(t){return t.county===l.currCity&&t.town===l.currDistrict}))}))})),f=function(t){l.currCity=t},b=function(t){l.currDistrict=t},d=function(t){l.infoBoxStoreId=t},j=function(t){l.keywords=t},O=function(t){l.showModal=t},p=function(t){l.location=t},h=function(t){l.stores=t},m=function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://raw.githubusercontent.com/kurotanshi/mask-map/master/raw/area-location.json").then((function(t){return t.json()}));case 2:e=t.sent,p(e);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),v=function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://kiang.github.io/pharmacies/json/points.json").then((function(t){return t.json()}));case 2:e=t.sent,n=e.features.map((function(t){return Object(a["a"])(Object(a["a"])({},t.properties),{},{latitude:t.geometry.coordinates[0],longitude:t.geometry.coordinates[1]})})),h(n);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),g={state:Object(r["r"])(l),setCurrCity:f,setCurrDistrict:b,setInfoBoxStoreId:d,setKeywords:j,setShowModal:O,setLocation:p,setStores:h,fetchLocations:m,fetchPharmacies:v},y={iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-violet.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]},w=[],k=Object(r["s"])({}),S=function(t){var e=u.a.marker([t.longitude,t.latitude],y).addTo(k.value).bindPopup('<h2 class="popup-name">'.concat(t.name,"</h2>"));e.markerId=t.id,e.lng=t.longitude,e.lat=t.latitude,w.push(e)},x=function(){w.length=0,k.value.eachLayer((function(t){t instanceof u.a.Marker&&k.value.removeLayer(t)}))},C=function(t){var e=w.find((function(e){return e.markerId===t}));k.value.flyTo(new u.a.LatLng(e.lng,e.lat),15),e.openPopup()},L=function(t){Object(r["l"])((function(){k.value=u.a.map(t,{center:[25.03,121.55],zoom:14}),u.a.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'<a target="_blank" href="https://www.openstreetmap.org/">© OpenStreetMap 貢獻者</a>',maxZoom:18}).addTo(k.value),Object(r["A"])((function(){return g.state.currDistrictInfo}),(function(t){k.value.panTo(new u.a.LatLng(t.latitude,t.longitude))})),Object(r["A"])((function(){return g.state.filteredStores}),(function(t){x(),t.forEach((function(t){return S(t)}))}))}))},M={triggerPopup:C,mapInit:L},I={class:"aside-menu"},_={class:"wraps"},P=Object(r["i"])(" 縣市："),D=Object(r["i"])(" 行政區："),B={class:"wraps"},R=Object(r["h"])("i",{class:"fas fa-search-location"},null,-1),A=Object(r["i"])(" 關鍵字搜尋： "),T={class:"store-lists"},z=["onClick"],U=["innerHTML"],H={class:"mask-info"},K=Object(r["h"])("i",{class:"fas fa-head-side-mask"},null,-1),V={class:"mask-info"},E=Object(r["h"])("i",{class:"fas fa-baby"},null,-1),J={class:"mask-info"},q=["onClick"],N=Object(r["h"])("i",{class:"fas fa-info-circle"},null,-1),X=Object(r["i"])(" 看詳細資訊 "),Y=[N,X];function Z(t,e,n,c,o,i){return Object(r["m"])(),Object(r["g"])("div",I,[Object(r["h"])("div",_,[Object(r["h"])("label",null,[P,Object(r["C"])(Object(r["h"])("select",{"onUpdate:modelValue":e[0]||(e[0]=function(t){return c.currCity=t})},[(Object(r["m"])(!0),Object(r["g"])(r["a"],null,Object(r["t"])(t.cityList,(function(t){return Object(r["m"])(),Object(r["g"])("option",{key:"city_".concat(t)},Object(r["v"])(t),1)})),128))],512),[[r["x"],c.currCity]])]),Object(r["h"])("label",null,[D,Object(r["C"])(Object(r["h"])("select",{"onUpdate:modelValue":e[1]||(e[1]=function(t){return c.currDistrict=t})},[(Object(r["m"])(!0),Object(r["g"])(r["a"],null,Object(r["t"])(t.districtList,(function(t){return Object(r["m"])(),Object(r["g"])("option",{key:"district_".concat(t.id)},Object(r["v"])(t.name),1)})),128))],512),[[r["x"],c.currDistrict]])])]),Object(r["h"])("div",B,[Object(r["h"])("label",null,[R,A,Object(r["C"])(Object(r["h"])("input",{type:"text",placeholder:"請輸入關鍵字","onUpdate:modelValue":e[2]||(e[2]=function(e){return t.keywords=e})},null,512),[[r["y"],t.keywords]])])]),Object(r["h"])("ul",T,[(Object(r["m"])(!0),Object(r["g"])(r["a"],null,Object(r["t"])(t.filteredStores,(function(t){return Object(r["m"])(),Object(r["g"])("li",{class:"store-info wraps",key:"store_".concat(t.id),onClick:function(e){return c.triggerPopup(t.id)}},[Object(r["h"])("h1",{innerHTML:c.keywordHighlight(t.name)},null,8,U),Object(r["h"])("div",H,[K,Object(r["h"])("span",null,"大人口罩: "+Object(r["v"])(t.mask_adult)+" 個",1)]),Object(r["h"])("div",V,[E,Object(r["h"])("span",null,"兒童口罩: "+Object(r["v"])(t.mask_child)+" 個",1)]),Object(r["h"])("div",J," 最後更新時間: "+Object(r["v"])(t.updated),1),Object(r["h"])("button",{class:"btn-store-detail",onClick:function(e){return c.openInfoBox(t.id)}},Y,8,q)],8,z)})),128))])])}var F=n("3835"),G=(n("ac1f"),n("5319"),n("4d63"),n("c607"),n("2c3e"),n("25f0"),{name:"asideMenu",setup:function(){var t=Object(r["k"])("mapStore"),e=Object(r["k"])("map"),n=e.triggerPopup,c=t.state,o=t.setCurrCity,i=t.setCurrDistrict,u=t.setKeywords,s=t.setShowModal,l=t.setInfoBoxStoreId,f=function(t){return t.replace(new RegExp(c.keywords,"g"),'<span class="highlight">'.concat(c.keywords,"</span>"))},b=function(t){l(t),s(!0)},d=Object(r["c"])({get:function(){return c.currCity},set:function(t){o(t)}}),j=Object(r["c"])({get:function(){return c.currDistrict},set:function(t){i(t)}}),O=Object(r["c"])({get:function(){return c.keywords},set:function(t){u(t)}});return Object(r["A"])((function(){return c.districtList}),(function(t){var e=Object(F["a"])(t,1),n=e[0];i(n.name)})),Object(a["a"])(Object(a["a"])({},Object(r["w"])(c)),{},{currCity:d,currDistrict:j,currKeywords:O,triggerPopup:n,openInfoBox:b,keywordHighlight:f})}}),Q=(n("6495"),n("6b0d")),W=n.n(Q);const $=W()(G,[["render",Z]]);var tt=$,et=function(t){return Object(r["p"])("data-v-a1f7c4b0"),t=t(),Object(r["n"])(),t},nt={class:"modal-mask"},rt={class:"modal-container"},ct={key:0,class:"modal-body"},ot=et((function(){return Object(r["h"])("span",{"aria-hidden":"true"},"×",-1)})),it=[ot],ut={class:"store-name"},at=et((function(){return Object(r["h"])("hr",null,null,-1)})),st=et((function(){return Object(r["h"])("h2",{class:"title"},"營業時間",-1)})),lt=et((function(){return Object(r["h"])("thead",null,[Object(r["h"])("tr",null,[Object(r["h"])("th"),Object(r["h"])("th",null,"ㄧ"),Object(r["h"])("th",null,"二"),Object(r["h"])("th",null,"三"),Object(r["h"])("th",null,"四"),Object(r["h"])("th",null,"五"),Object(r["h"])("th",null,"六"),Object(r["h"])("th",null,"日")])],-1)})),ft=et((function(){return Object(r["h"])("th",null,"早上",-1)})),bt=et((function(){return Object(r["h"])("th",null,"中午",-1)})),dt=et((function(){return Object(r["h"])("th",null,"晚上",-1)})),jt={class:"title"},Ot={class:"title"},pt={key:0,class:"title"};function ht(t,e,n,c,o,i){return Object(r["m"])(),Object(r["e"])(r["b"],{name:"modal"},{default:Object(r["B"])((function(){return[Object(r["C"])(Object(r["h"])("div",nt,[Object(r["h"])("div",{class:"modal-wrapper",onClick:e[1]||(e[1]=Object(r["D"])((function(){return c.close&&c.close.apply(c,arguments)}),["self"]))},[Object(r["h"])("div",rt,[c.currentStore?(Object(r["m"])(),Object(r["g"])("div",ct,[Object(r["h"])("button",{type:"button",class:"modal-close",onClick:e[0]||(e[0]=function(){return c.close&&c.close.apply(c,arguments)})},it),Object(r["h"])("h1",ut,Object(r["v"])(c.currentStore.name),1),at,st,Object(r["h"])("table",null,[lt,Object(r["h"])("tbody",null,[Object(r["h"])("tr",null,[ft,(Object(r["m"])(!0),Object(r["g"])(r["a"],null,Object(r["t"])(c.servicePeriods[0],(function(t,e){return Object(r["m"])(),Object(r["g"])("td",{key:"m_".concat(e)},Object(r["v"])(t),1)})),128))]),Object(r["h"])("tr",null,[bt,(Object(r["m"])(!0),Object(r["g"])(r["a"],null,Object(r["t"])(c.servicePeriods[1],(function(t,e){return Object(r["m"])(),Object(r["g"])("td",{key:"a_".concat(e)},Object(r["v"])(t),1)})),128))]),Object(r["h"])("tr",null,[dt,(Object(r["m"])(!0),Object(r["g"])(r["a"],null,Object(r["t"])(c.servicePeriods[2],(function(t,e){return Object(r["m"])(),Object(r["g"])("td",{key:"n_".concat(e)},Object(r["v"])(t),1)})),128))])])]),Object(r["h"])("h2",jt,"地址: "+Object(r["v"])(c.currentStore.address),1),Object(r["h"])("h2",Ot,"電話: "+Object(r["v"])(c.currentStore.phone),1),c.currentStore.custom_note?(Object(r["m"])(),Object(r["g"])("h2",pt,"備註: "+Object(r["v"])(c.currentStore.custom_note),1)):Object(r["f"])("",!0)])):Object(r["f"])("",!0)])])],512),[[r["z"],t.showModal]])]})),_:1})}n("1276");var mt={name:"Lightbox",setup:function(){var t=Object(r["k"])("mapStore"),e=t.state,n=t.setShowModal,c=Object(r["c"])((function(){return e.stores.filter((function(t){return t.id===e.infoBoxStoreId}))[0]})),o=Object(r["c"])((function(){var t,e=(null===(t=c.value)||void 0===t?void 0:t["service_periods"])||"";return e=e.replace(/N/g,"O").replace(/Y/g,"X"),e?[e.slice(0,7).split(""),e.slice(7,14).split(""),e.slice(14,21).split("")]:e})),i=function(){n(!1)};return Object(a["a"])(Object(a["a"])({},Object(r["w"])(e)),{},{currentStore:c,servicePeriods:o,close:i})}};n("e044"),n("ebb8"),n("d529");const vt=W()(mt,[["render",ht],["__scopeId","data-v-a1f7c4b0"]]);var gt=vt,yt={class:"mask-map",id:"mask-map"};function wt(t,e,n,c,o,i){return Object(r["m"])(),Object(r["g"])("div",yt)}var kt={name:"maskMap",setup:function(){var t=Object(r["k"])("map");t.mapInit("mask-map")}};const St=W()(kt,[["render",wt]]);var xt=St,Ct={name:"App",components:{asideMenu:tt,lightbox:gt,maskMap:xt},setup:function(){Object(r["o"])("mapStore",g),Object(r["o"])("map",M),g.fetchLocations(),g.fetchPharmacies()}};n("cf16");const Lt=W()(Ct,[["render",o]]);var Mt=Lt,It=n("5502"),_t=Object(It["a"])({state:{currCity:"臺北市",currDistrict:"北投區",location:[],stores:[],keywords:"",showModal:!1,infoBoxStoreId:null},getters:{cityList:function(t){return t.location.map((function(t){return t.name}))},districtList:function(t){var e;return(null===(e=t.location.find((function(e){return e.name===t.currCity})))||void 0===e?void 0:e.districts)||[]},filteredStores:function(t){var e=t.stores;return t.keywords?e.filter((function(e){return e.name.includes(t.keywords)})):e.filter((function(e){return e.county===t.currCity&&e.town===t.currDistrict}))},currentDistrictInfo:function(t,e){return e.districtList.find((function(e){return e.name===t.currDistrict}))||{}}},mutations:{setcurrCity:function(t,e){t.currCity=e},setcurrDistrict:function(t,e){t.currDistrict=e},setAreaLocation:function(t,e){t.location=e},setStores:function(t,e){t.stores=e},setKeywords:function(t,e){t.keywords=e},setShowModal:function(t,e){t.showModal=e},setInfoBoxStoreId:function(t,e){t.infoBoxStoreId=e}},actions:{fetchLocations:function(t){return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.commit,e.next=3,fetch("https://raw.githubusercontent.com/kurotanshi/mask-map/master/raw/area-location.json").then((function(t){return t.json()}));case 3:r=e.sent,n("setAreaLocation",r);case 5:case"end":return e.stop()}}),e)})))()},fetchPharmacies:function(t){return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,r,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.commit,e.next=3,fetch("https://kiang.github.io/pharmacies/json/points.json").then((function(t){return t.json()}));case 3:r=e.sent,c=r.features.map((function(t){return Object(a["a"])(Object(a["a"])({},t.properties),{},{latitude:t.geometry.coordinates[0],longitude:t.geometry.coordinates[1]})})),n("setStores",c);case 6:case"end":return e.stop()}}),e)})))()}},modules:{}});Object(r["d"])(Mt).use(_t).mount("#app")},6495:function(t,e,n){"use strict";n("5628")},cf16:function(t,e,n){"use strict";n("418d")},d529:function(t,e,n){"use strict";n("0900")},e044:function(t,e,n){"use strict";n("283a")},ebb8:function(t,e,n){"use strict";n("0f5c")}});